{% extends 'storage_rental/base.html' %}
{% load static %}

{% block header %}
  <title>Self Storage - Главная</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-providers/1.10.1/leaflet-providers.min.js" integrity="sha256-EV/ywRtxUOBICwOsLtPpYEONoBF6g+ShAcLX1Ts48GA=" crossorigin="anonymous"></script>
{% endblock %}

{% block content %}
<div class="container">
  <main role="main">
        <div class="row">
          <div class="col-md-8 blog-main">
            <div class="blog-post">
              <h2 class="blog-post-title">Вам нужно арендовать бокс или отдать вещи на сезонное хранение?</h2>
              <hr>
              <h4>Всего 4 простых <span class="badge badge-warning">шага:</span></h4>
              <ul class="list-group list-group-flush">
                <li class="list-group-item">1. Выберите бокс онлайн или по телефону</li>
                <li class="list-group-item">2. Заключите договор и оплатите услугу</li>
                <li class="list-group-item">3. Получите код доступа к складу</li>
                <li class="list-group-item">4. Перевезите вещи на склад или закажите доставку</li>
              </ul>
            </div><!-- /.blog-post -->
          </div><!-- /.blog-main -->

          <aside class="col-md-4 blog-sidebar">

            <div class="p-3 mb-3 bg-light rounded">
              <h4 class="font-italic"> О нас</h4>
              <p class="mb-0">SelfStorage – лидер российского рынка в сфере услуг индивидуального хранения. Свои вещи нам доверили уже более 21000 арендаторов!</p>
            </div>

          </aside><!-- /.blog-sidebar -->
        </div><!-- /.row -->
  </main><!-- /.container -->
  <hr>
  <h2>Наши <span class="badge badge-warning">СКЛАДЫ</span></h2>
  <hr>

  <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner">
      {% for storage in all_places %}
        <div class="carousel-item{% if forloop.first %} active{% endif %}">
          <img src="{{ storage.image }}" height="700px;" class="d-block w-100" alt="{{ storage.name }}">
          <div class="carousel-caption d-none d-md-block">
            <h5>{{ storage.name }}, {{ storage.address }}</h5>
            Стоимость за первый м²: {{ storage.base_price }}<br/>
            Стоимость за каждый дополнительный м²: {{ storage.additional_price }}
          </div>
        </div>
      {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-target="#carouselExampleCaptions" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-target="#carouselExampleCaptions" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </button>
  </div>

  <hr>
  <h2>Карта <span class="badge badge-warning">СКЛАДОВ</span></h2>
  <hr>

  <div id="map" class="container" style="height:400px"></div>

  {{ all_places|json_script:"places-geojson" }}

  <script>
    var map = L.map('map');
    map.setView([51.6720400, 39.1843000], 11);

    L.tileLayer.provider('OpenStreetMap.Mapnik').addTo(map);

    function loadJSON(elementId){
      let element = document.getElementById(elementId);

      return JSON.parse(element.textContent);
    }

    let places = loadJSON('places-geojson');

    L.geoJSON(places, {
        pointToLayer: function(geoJsonPoint, latlng) {
          if (geoJsonPoint.geometry.type != "Point"){
            return
          }

          let marker = L.marker(latlng, {});

          marker.bindTooltip(geoJsonPoint.properties.full_name);

          return marker;
        }
    }).addTo(map);
  </script>

  <footer class="footer-area section-padding">
    <div class="footer-bottom d-flex justify-content-center align-items-center flex-wrap">
      <p class="footer-text m-0">
        Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
      </p>
    </div>
  </footer>


 </div>





{% endblock  %}
